<h2>âš¾ Batter POV Tunnel Visualization</h2>

<div class="controls">
    <label for="pitcher-select">Select Pitcher:</label>
    <select id="pitcher-select" [(ngModel)]="selectedPitcherId" (change)="onPitcherSelect(selectedPitcherId)">

        <option [value]="null">-- Select a Pitcher --</option>

        @for (group of groupedPitchers$ | async; track group.teamCode) {
        <optgroup [label]="group.teamCode">
            @for (pitcher of group.pitchers; track pitcher.id) {
            <option [value]="pitcher.id">{{ pitcher.name }}</option>
            }
        </optgroup>
        }
    </select>

    <ng-container *ngIf="selectedPitcherId">
        <label for="pitch1-select">Pitch 1:</label>
        <select id="pitch1-select" [(ngModel)]="pitchType1" (change)="updateTunnelVisualization()">
            <option [value]="null">-- Pitch 1 --</option>
            @for (type of availablePitchTypes; track type) {
            <option [value]="type">{{ type }}</option>
            }
        </select>

        <label for="pitch2-select">Pitch 2:</label>
        <select id="pitch2-select" [(ngModel)]="pitchType2" (change)="updateTunnelVisualization()">
            <option [value]="null">-- Pitch 2 --</option>
            @for (type of availablePitchTypes; track type) {
            <option [value]="type">{{ type }}</option>
            }
        </select>
    </ng-container>
</div>

<hr>

<div *ngIf="chartData" class="chart-container">
    <h2>Trajectory Visualization</h2>
    <div #chartContainer id="trajectory-chart">
    </div>
</div>

<div *ngIf="!chartData && selectedPitcherId" class="message">
    <p>Select two pitch types to view the tunnel visualization.</p>
</div>